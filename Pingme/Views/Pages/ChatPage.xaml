<Page x:Class="Pingme.Views.Pages.ChatPage"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:packIcon="http://materialdesigninxaml.net/winfx/xaml/shared"
        xmlns:local="clr-namespace:Pingme.Views.Pages"
        xmlns:controls="clr-namespace:Pingme.Views.Controls"
        mc:Ignorable="d"
        Title="ChatPage" Height="Auto" Width="Auto"
        FontFamily="Times New Roman"
        Background="#F2F2F2">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="1.5*"/>
            <ColumnDefinition Width="5*"/>
            <ColumnDefinition Width="1.37*"/>
        </Grid.ColumnDefinitions>

        <!--  Sidebar trái (logo và danh sách tài khoản) -->
        <Border Background="#FFFFFF"
        CornerRadius="10"
        Margin="10,10,10,10">
            <StackPanel VerticalAlignment="Top" HorizontalAlignment="Center" Margin="0,10">

                <!-- Logo Ứng dụng -->
                <Ellipse Width="60" Height="60" Margin="5,10">
                    <Ellipse.Fill>
                        <ImageBrush ImageSource="/Assets/Icons/logo-app.jpg"/>
                    </Ellipse.Fill>
                </Ellipse>

                <!-- Các tài khoản -->
                <Button Content="Wk" Style="{StaticResource AccButton}" Margin="0,10"/>
                <Button Content="Fam" Style="{StaticResource AccButton}" Margin="0,10"/>
                <Button Content="B.F" Style="{StaticResource AccButton}" Margin="0,10"/>

                <!-- Nút thêm -->
                <Button Content="+" Style="{StaticResource AccButton}" FontSize="39" Margin="0,10" RenderTransformOrigin="0.508,0.389"/>
            </StackPanel>
        </Border>

        <!-- Danh sách nhóm, bạn bè và tìm kiếm -->
        <Grid Grid.Column="1" Margin="0,10,0,10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Tìm kiếm -->
                <RowDefinition Height="*"/>
                <!-- Danh sách -->
            </Grid.RowDefinitions>

            <!-- Tìm kiếm -->
            <Border Grid.Row="0" Background="#FFFFFF" CornerRadius="10" Padding="10" Margin="0,0,0,10">
                <DockPanel VerticalAlignment="Center">
                    <Button Grid.Column="0" Width="50" Height="25" Margin="0"
                            Background="Transparent" BorderThickness="0" >
                        <Image Source="/Assets/Icons/search.png" Width="25" Height="25"/>
                    </Button>
                    <Border Background="#F2F2F2" CornerRadius="10" Width="200">
                        <TextBox 
                            Name="Search"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="Black"
                            FontWeight="Bold"
                            Text="Tìm kiếm"
                            Padding="5"
                            VerticalContentAlignment="Center"
                            HorizontalContentAlignment="Center"
                            Width="180"
                            GotFocus="Search_GotFocus"
                            LostFocus="Search_LostFocus"/>
                    </Border>
                </DockPanel>
            </Border>



            <!-- Danh sách nhóm, bạn bè  -->
            <ScrollViewer Grid.Row="1" 
                VerticalScrollBarVisibility="Hidden" 
                PanningMode="VerticalOnly" 
                CanContentScroll="True">
                <StackPanel>
                    <controls:ContactItem ContactName="Group 10 (NT106.P21.ANTT)" AvatarPath="/Assets/Images/a1.jpg"/>
                    <controls:ContactItem ContactName="Anh Tú" AvatarPath="/Assets/Icons/avater-default.png"/>
                    <controls:ContactItem ContactName="Quốc Việt" AvatarPath="/Assets/Icons/avater-default.png"/>
                    <controls:ContactItem ContactName="Nhật Trường" AvatarPath="/Assets/Icons/avater-default.png"/>
                    <controls:ContactItem ContactName="Anh Tuấn" AvatarPath="/Assets/Icons/avater-default.png"/>
                    <controls:ContactItem ContactName="Hoàng Anh" AvatarPath="/Assets/Icons/avater-default.png"/>
                    <controls:ContactItem ContactName="Hoàng Sương" AvatarPath="/Assets/Icons/avater-default.png"/>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- Khung chat chính -->
        <Grid Grid.Column="2" Margin="0,0,10,0" >
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Thanh tiêu đề -->
            <StackPanel>
                <controls:ChatHeader ContactName="Group 10 (NT106.P21.ANTT)" AvatarPath="/Assets/Images/a1.jpg"/>

            </StackPanel>

            <!-- Khung chat -->
            <Border Grid.Row="1" CornerRadius="10" Padding="5" Margin="10,10,0,10">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#C7FADF" Offset="0.0"/>
                        <GradientStop Color="#94B9FF" Offset="1.0"/>
                    </LinearGradientBrush>
                </Border.Background>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Danh sách tin nhắn -->
                    <ScrollViewer Grid.Row="0" 
                                  VerticalScrollBarVisibility="Hidden" 
                                  PanningMode="VerticalOnly" 
                                  CanContentScroll="True">
                        <StackPanel Name="ChatPanel" Margin="10">
                            <controls:ChatSeparator DateText="11 / 3 / 2025"/>
                            <controls:MessageChat AvatarPath="/Assets/Images/a9.jpg" Message="Chào mọi người"/>
                            <controls:MessageChat AvatarPath="/Assets/Images/a1.jpg" Message="Chào các bạn"/>
                            <controls:UserChat AvatarPath="/Assets/Images/a2.jpg" Message="Giờ mình phân công công việc nha"/>
                            <controls:MessageChat AvatarPath="/Assets/Images/a9.jpg" Message="Oke bạn"/>
                            <controls:UserChat AvatarPath="/Assets/Images/a2.jpg" Message="Mọi người vào nhận công việc nha"/>
                            <controls:ChatSeparator DateText="28 / 3 / 2025"/>
                            <controls:SystemNotification AvatarPath="/Assets/Images/a7.jpg" Message="Đã rời khỏi nhóm"/>
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Khung nhập tin nhắn -->
                    <Border Grid.Row="1" Background="#FFFFFF" CornerRadius="10" Margin="0" Padding="5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>


                            <Button Grid.Column="0" Margin="4,0,0,0"
                                    Background="Transparent" BorderThickness="0"
                                    ToolTip="Gửi">
                                <Image Source="/Assets/Icons/foldericon.png" Width="50" Height="42"/>
                            </Button>
                            <Border Grid.Column="1" Background="#E1E1E1" CornerRadius="10" VerticalAlignment="Center" Margin="10,0">
                                <TextBox
                                    Name="MessageInput"
                                    Height="40"
                                    Margin="10,0"
                                    Padding="5"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    FontWeight="Bold"
                                    FontSize="16"
                                    Foreground="Black"
                                    VerticalContentAlignment="Center"
                                    HorizontalContentAlignment="Left"
                                    Text="Nhắn gì đó . . ."
                                    GotFocus="MessageInput_GotFocus"
                                    LostFocus="MessageInput_LostFocus"/>
                            </Border>

                            <Button Grid.Column="2" Margin="5,5,2,3"
                                    Background="Transparent" BorderThickness="0"
                                    ToolTip="Gửi">
                                <Image Source="/Assets/Icons/sendicon.png" Width="51" Height="50"/>
                            </Button>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>

        <!-- Sidebar phải (thông tin nhóm, thành viên, tài liệu) -->
        <Grid Grid.Column="3" Margin="0,0,10,0" >
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Thanh nút -->
            <Border Grid.Row="0" 
                    Background="#F2F2F2" 
                    CornerRadius="10" 
                    Padding="10" 
                    Margin="0,0,0,0">
                <UniformGrid Columns="4" HorizontalAlignment="Stretch" VerticalAlignment="Center">
                    <Button Style="{StaticResource ButtonItem}" Tag="/Assets/Icons/homeicon.png" Margin="5" />
                    <Button Style="{StaticResource ButtonItem}" Tag="/Assets/Icons/notification.png" Margin="5"/>
                    <Button Style="{StaticResource ButtonItem}" Tag="/Assets/Icons/setting.png" Margin="5"/>
                    <Button Style="{StaticResource ButtonItem}" Tag="/Assets/Icons/avatar-default.png" Margin="5"/>
                </UniformGrid>
            </Border>

            <Border Grid.Row="1" 
                Background="#FFFFFF" 
                CornerRadius="10" 
                Padding="10" 
                Margin="0,0,0,10">
                <UniformGrid Columns="4" HorizontalAlignment="Stretch" VerticalAlignment="Center">
                    <Button Style="{StaticResource ButtonItem}" Tag="/Assets/Icons/callicon.png" Margin="5"/>
                    <Button Style="{StaticResource ButtonItem}" Tag="/Assets/Icons/videocallicon.png" Margin="5"/>
                    <Button Style="{StaticResource ButtonItem}" Tag="/Assets/Icons/contacticon.png" Margin="5"/>
                    <Button Style="{StaticResource ButtonItem}" Tag="/Assets/Icons/paperclipicon.png" Margin="5"/>
                </UniformGrid>
            </Border>

            <Border Grid.Row="2" 
                    Background="#FFFFFF" 
                    CornerRadius="10" 
                    Padding="10" 
                    Margin="0,0,0,10"
                    HorizontalAlignment="Stretch">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <!-- Thanh tiêu đề -->
                        <RowDefinition Height="*"/>
                        <!-- Danh sách scroll -->
                    </Grid.RowDefinitions>

                    <!-- Thanh tiêu đề -->
                    <Border Grid.Row="0"
                            Background="#F2F2F2" 
                            CornerRadius="10" 
                            Padding="10" 
                            Margin="0,0,0,10">
                        <TextBlock Text="Thành viên" 
                                   FontWeight="Bold" 
                                   HorizontalAlignment="Center"
                                   FontSize="14"/>
                    </Border>

                    <!-- Danh sách thành viên -->
                    <ScrollViewer Grid.Row="1"
                      VerticalScrollBarVisibility="Hidden" 
                        PanningMode="VerticalOnly" 
                        CanContentScroll="True">
                        <StackPanel>
                            <controls:GroupMember ContactName="Anh Tú" AvatarPath="/Assets/Icons/avater-default.png"/>
                            <controls:GroupMember ContactName="Quốc Việt" AvatarPath="/Assets/Icons/avater-default.png"/>
                            <controls:GroupMember ContactName="Nhật Trường" AvatarPath="/Assets/Icons/avater-default.png"/>
                            <controls:GroupMember ContactName="Anh Tuấn" AvatarPath="/Assets/Icons/avater-default.png"/>
                            <controls:GroupMember ContactName="Hoàng Anh" AvatarPath="/Assets/Icons/avater-default.png"/>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>


            <Border Grid.Row="3" Background="#FFFFFF" CornerRadius="10" Padding="10" Margin="0,10,0,10">
                <StackPanel>

                    <!-- Thanh tiêu đề -->
                    <Border Background="#F2F2F2" CornerRadius="10" Padding="10" Margin="0,0,0,10">
                        <TextBlock Text="Tài liệu"
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       FontSize="14"/>
                    </Border>

                    <!-- Hình ảnh & Video -->
                    <Border Background="#F2F2F2" CornerRadius="10" Padding="10" Margin="0,0,0,10">
                        <StackPanel>
                            <ToggleButton x:Name="ToggleImages" Background="Transparent" BorderThickness="0"
                              HorizontalContentAlignment="Stretch" Padding="0">
                                <DockPanel LastChildFill="False">
                                    <TextBlock Text="Hình ảnh &amp; Video"
                                   FontWeight="Bold"
                                   FontSize="14"
                                   VerticalAlignment="Center"
                                   DockPanel.Dock="Left"/>

                                    <Path Data="M 8 0 L 0 -8 L 0 8 Z"
                                          Fill="Black"
                                          Width="16" Height="8"
                                          VerticalAlignment="Center"
                                          DockPanel.Dock="Right"
                                          RenderTransformOrigin="0.5,0.5">
                                        <Path.RenderTransform>
                                            <RotateTransform Angle="{Binding IsChecked, ElementName=ToggleImages, Converter={StaticResource BoolToAngleConverter}}"/>
                                        </Path.RenderTransform>
                                    </Path>
                                </DockPanel>
                            </ToggleButton>

                            <WrapPanel x:Name="ImagePanel" Visibility="Collapsed" Margin="0,10,0,0" ItemHeight="100" ItemWidth="100">
                                <Image Source="/Assets/Images/a11.jpg" Width="90" Height="90" Margin="5" Stretch="UniformToFill" ClipToBounds="True"/>
                                <Image Source="/Assets/Images/a13.jpg" Width="90" Height="90" Margin="5" Stretch="UniformToFill" ClipToBounds="True"/>
                                <Image Source="/Assets/Images/a3.jpg" Width="90" Height="90" Margin="5" Stretch="UniformToFill" ClipToBounds="True"/>
                                <Image Source="/Assets/Images/a14.jpg" Width="90" Height="90" Margin="5" Stretch="UniformToFill" ClipToBounds="True"/>
                                <Image Source="/Assets/Images/a15.jpg" Width="90" Height="90" Margin="5" Stretch="UniformToFill" ClipToBounds="True"/>
                                <Image Source="/Assets/Images/a5.jpg" Width="90" Height="90" Margin="5" Stretch="UniformToFill" ClipToBounds="True"/>
                            </WrapPanel>

                            <StackPanel.Triggers>
                                <EventTrigger RoutedEvent="ToggleButton.Checked" SourceName="ToggleImages">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ImagePanel" Storyboard.TargetProperty="Visibility">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Visible}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                                <EventTrigger RoutedEvent="ToggleButton.Unchecked" SourceName="ToggleImages">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ImagePanel" Storyboard.TargetProperty="Visibility">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Collapsed}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </StackPanel.Triggers>
                        </StackPanel>
                    </Border>

                    <!-- MỤC 2: Tài liệu -->
                    <Border Background="#F2F2F2" CornerRadius="10" Padding="10" Margin="0,0,0,10">
                        <StackPanel>
                            <ToggleButton x:Name="ToggleFiles" Background="Transparent" BorderThickness="0"
                              HorizontalContentAlignment="Stretch" Padding="0">
                                <DockPanel LastChildFill="False">
                                    <TextBlock Text="Tài liệu" FontWeight="Bold" FontSize="14" VerticalAlignment="Center" DockPanel.Dock="Left"/>
                                    <Path Data="M 8 0 L 0 -8 L 0 8 Z" Fill="Black" Width="16" Height="8"
                                              VerticalAlignment="Center" DockPanel.Dock="Right"
                                              RenderTransformOrigin="0.5,0.5">
                                        <Path.RenderTransform>
                                            <RotateTransform Angle="{Binding IsChecked, ElementName=ToggleFiles, Converter={StaticResource BoolToAngleConverter}}"/>
                                        </Path.RenderTransform>
                                    </Path>
                                </DockPanel>
                            </ToggleButton>

                            <StackPanel x:Name="FilePanel" Visibility="Collapsed" Margin="0,10,0,0">
                                <TextBlock Text="File1.pdf" Margin="5"/>
                                <TextBlock Text="File2.docx" Margin="5"/>
                            </StackPanel>

                            <StackPanel.Triggers>
                                <EventTrigger RoutedEvent="ToggleButton.Checked" SourceName="ToggleFiles">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="FilePanel" Storyboard.TargetProperty="Visibility">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Visible}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                                <EventTrigger RoutedEvent="ToggleButton.Unchecked" SourceName="ToggleFiles">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="FilePanel" Storyboard.TargetProperty="Visibility">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Collapsed}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </StackPanel.Triggers>
                        </StackPanel>
                    </Border>

                    <!-- MỤC 3: Liên kết -->
                    <Border Background="#F2F2F2" CornerRadius="10" Padding="10">
                        <StackPanel>
                            <ToggleButton x:Name="ToggleLinks" Background="Transparent" BorderThickness="0"
                              HorizontalContentAlignment="Stretch" Padding="0">
                                <DockPanel LastChildFill="False">
                                    <TextBlock Text="Liên kết" FontWeight="Bold" FontSize="14" VerticalAlignment="Center" DockPanel.Dock="Left"/>
                                    <Path Data="M 8 0 L 0 -8 L 0 8 Z" Fill="Black" Width="16" Height="8"
                                              VerticalAlignment="Center" DockPanel.Dock="Right"
                                              RenderTransformOrigin="0.5,0.5">
                                        <Path.RenderTransform>
                                            <RotateTransform Angle="{Binding IsChecked, ElementName=ToggleLinks, Converter={StaticResource BoolToAngleConverter}}"/>
                                        </Path.RenderTransform>
                                    </Path>
                                </DockPanel>
                            </ToggleButton>

                            <StackPanel x:Name="LinkPanel" Visibility="Collapsed" Margin="0,10,0,0">
                                <TextBlock Text="https://example.com" Margin="5"/>
                                <TextBlock Text="https://another-link.com" Margin="5"/>
                            </StackPanel>

                            <StackPanel.Triggers>
                                <EventTrigger RoutedEvent="ToggleButton.Checked" SourceName="ToggleLinks">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LinkPanel" Storyboard.TargetProperty="Visibility">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Visible}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                                <EventTrigger RoutedEvent="ToggleButton.Unchecked" SourceName="ToggleLinks">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LinkPanel" Storyboard.TargetProperty="Visibility">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Collapsed}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </StackPanel.Triggers>
                        </StackPanel>
                    </Border>

                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Page>
